<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TP HUB STORE STOK</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: #0f172a;
  color: #fff;
  margin: 0;
}
.container {
  max-width: 1000px;
  margin: auto;
  padding: 15px;
}
.header {
  text-align: center;
  margin-bottom: 20px;
}
.header h1 {
  margin: 0;
  font-size: 28px;
  color: #38bdf8;
}
.card {
  background: #020617;
  padding: 20px;
  border-radius: 14px;
  margin-bottom: 25px;
  box-shadow: 0 10px 25px rgba(0,0,0,0.4);
}
input, button {
  width: 100%;
  padding: 10px;
  margin-top: 8px;
  border-radius: 8px;
  border: none;
}
button {
  background: #2563eb;
  color: #fff;
  font-weight: bold;
  cursor: pointer;
}
button:hover {
  background: #1d4ed8;
}
table {
  width: 100%;
  border-collapse: collapse;
  background: #020617;
}
th, td {
  padding: 10px;
  text-align: center;
  border-bottom: 1px solid #334155;
}
th {
  background: #1e293b;
}
.total {
  color: #22c55e;
  font-weight: bold;
}
.delete-btn {
  background: #dc2626;
  color: white;
  border-radius: 6px;
  padding: 5px 10px;
}
.note {
  font-size: 13px;
  opacity: 0.8;
}
.footer {
  text-align: center;
  font-size: 12px;
  opacity: 0.6;
  margin-top: 20px;
}
</style>
</head>

<body>

<div class="container">

  <!-- HEADER -->
  <div class="header">
    <h1>üè™ TP HUB STORE STOK</h1>
    <p class="note">Input angka saja ‚Ä¢ 1 = 1M</p>
  </div>

  <!-- PANDUAN -->
  <div class="card">
    <h3>üìò Panduan Singkat</h3>
    <ul style="line-height:1.7;padding-left:18px;">
      <li><b>1 = 1M (1 juta)</b> ‚Üí isi angka saja</li>
      <li>Gunakan <b>Nama / Nick ROK yang sama</b> setiap update</li>
      <li>Klik <b>Simpan Stok</b> untuk menambah / update</li>
      <li>Stok otomatis masuk ke <b>TOTAL</b></li>
      <li>Gunakan tombol <b>Hapus</b> hanya untuk stok sendiri</li>
    </ul>
    <p class="note">
      ‚ö†Ô∏è Gunakan halaman ini dengan jujur demi kepentingan aliansi.
    </p>
  </div>

  <!-- FORM INPUT -->
  <div class="card">
    <h3>‚ûï Input Stok SDA</h3>
    <form id="form">
      <input id="nama" placeholder="Nama / Nick ROK" required>
      <input id="food" type="number" placeholder="Food (M)">
      <input id="wood" type="number" placeholder="Wood (M)">
      <input id="stone" type="number" placeholder="Stone (M)">
      <input id="gold" type="number" placeholder="Gold (M)">
      <button type="submit">Simpan Stok</button>
    </form>
    <p id="status"></p>
  </div>

  <!-- TABEL STOK -->
  <div class="card">
    <h3>üìä Stok SDA Tersedia</h3>
    <table>
      <thead>
        <tr>
          <th>Nama</th>
          <th>Food</th>
          <th>Wood</th>
          <th>Stone</th>
          <th>Gold</th>
          <th>Aksi</th>
        </tr>
      </thead>
      <tbody id="data"></tbody>
      <tfoot>
        <tr class="total">
          <td>TOTAL</td>
          <td id="tFood"></td>
          <td id="tWood"></td>
          <td id="tStone"></td>
          <td id="tGold"></td>
          <td>-</td>
        </tr>
      </tfoot>
    </table>
  </div>

  <div class="footer">
    ¬© TP HUB STORE STOK
  </div>

</div>

<script>
const url = "https://script.google.com/macros/s/AKfycbxsT7TzxPmqgi-fe8iT8HJQG8v2Vgsti0KuVZLD6t5kRx82-Nv-mOUd5McPgzBMvYlj/exec";

document.getElementById("form").onsubmit = e => {
  e.preventDefault();

  fetch(url, {
    method: "POST",
    body: JSON.stringify({
      nama: nama.value,
      food: food.value || 0,
      wood: wood.value || 0,
      stone: stone.value || 0,
      gold: gold.value || 0
    })
  }).then(() => {
    status.innerText = "‚úÖ Stok berhasil disimpan";
    form.reset();
    loadData();
  });
};

function hapus(nama) {
  if (!confirm("Hapus stok " + nama + "?")) return;

  fetch(url, {
    method: "POST",
    body: JSON.stringify({
      action: "delete",
      nama: nama
    })
  }).then(() => loadData());
}

function loadData() {
  fetch(url)
    .then(r => r.json())
    .then(d => {
      let html = "";
      d.list.forEach(r => {
        html += `
        <tr>
          <td>${r.nama}</td>
          <td>${r.food}M</td>
          <td>${r.wood}M</td>
          <td>${r.stone}M</td>
          <td>${r.gold}M</td>
          <td>
            <button class="delete-btn" onclick="hapus('${r.nama}')">Hapus</button>
          </td>
        </tr>`;
      });
      data.innerHTML = html;

      tFood.innerText  = d.total.food  + "M";
      tWood.innerText  = d.total.wood  + "M";
      tStone.innerText = d.total.stone + "M";
      tGold.innerText  = d.total.gold  + "M";
    });
}

loadData();
</script>

</body>
  </html>
